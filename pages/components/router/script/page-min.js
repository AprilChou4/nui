Nui.define("./ajax",function(){var e=$.ajax;return function(n){"string"==typeof n&&(n={url:n,dataType:"json"});var t=n.success||$.noop,a=n.error||$.noop;return n.success=function(){t.apply(this,arguments)},n.error=function(){a.apply(this,arguments)},e($.extend(!0,{cache:!1,dataType:"json",statusCode:{404:function(){},502:function(){}}},n))}}),Nui.define("../tpls/seeVoucher",function(){return this.renders("这是查凭证页面，页面完整url是：<% url %>，路径是：<% path %><% if param %><br>参数分别是：<% each param %><% $index %>=<% $value %>，<% /each %><% /if %>")}),Nui.define("./modules/seeVoucher",["../tpls/seeVoucher","template"],function(e,n){return function(t,a,r){a.html(n.render(e,r))}}),Nui.define("../tpls/recordVoucher",function(){return this.renders("这是录凭证页面，页面完整url是：<% url %>，路径是：<% path %>")}),Nui.define("./modules/recordVoucher",["../tpls/recordVoucher","template"],function(e,n){return function(t,a,r){a.html(n.render(e,r))}}),Nui.define("../tpls/index",function(){return this.renders("这是首页，页面完整url是：<% url %>，路径是：<% path %>")}),Nui.define("./modules/index",["../tpls/index","template"],function(e,n){return function(t,a,r){a.html(n.render(e,r))}}),Nui.define("{cpns}/router",function(){return this.extend("component",{static:{_trigger:!1,_domain:location.protocol+"//"+location.host,_paths:{},_params:{},_alias:{},_cache:{},_cacheContainer:{},_replace:function(e){return e.replace(this._domain,"").replace(/^\#\!?/,"").replace(/^([^\/])/,"/$1").replace(/\/$/g,"")},alias:function(e){return $.extend(this._alias,e||{})},_setCache:function(e){var n=this,e=n._oldhash;e&&Nui.each(n._cacheContainer,function(t,a){if(a===e)return n._cache[e]=t.html(),!1})},_change:function(){var e=this,n=location.hash,t=e._replace(n);$.isEmptyObject(e._paths)&&$.isEmptyObject(e._params)||(e._setCache(),Nui.each([e._paths,e._params],function(a,r){var i=!1;if(Nui.each(a,function(a){if(0===r&&t===a.path||1===r&&0===t.indexOf(a.path)){var o=t.replace(a.path,"").replace(/^\//,"");if(o=o?o.split("/"):[],o.length===a.params.length){var c;Nui.each(a.params,function(e,n){c||(c={}),c[e]=o[n]}),e._cacheContainer[n]=a.container;var u=e._cache[n];return a.render(a.target,a.container,{path:a.path,url:t,param:c,cache:u}),e._trigger=i=!0,!1}}}),i)return!1}),e._trigger||Nui.each(e._instances,function(n){if(!e._hasEnter&&!0===n.options.enter)return e._hasEnter=!0,n.target.eq(0).trigger("click"),e._trigger=!0,!1})),e._oldhash=n},_bindHashchange:function(){var e=this;if(Nui.bsie7){var n=function(n){var t=location.hash;return e._oldhash!==t&&!n};setInterval(function(){n()&&e._change()},100),n(!0)}else Nui.win.on("hashchange",function(){e._change()})},trigger:function(){this._trigger||this._change()},$ready:null},options:{path:"",container:null,enter:!1,split:!1,onBefore:null,onRender:null},_init:function(){var e=this,n=e.constructor;e._exec()&&!n._bind&&(n._bind=!0,n._bindHashchange())},_exec:function(){var e=this,n=e.options,t=e.constructor,a=e._getTarget();if(n.path&&a){e.path=e._setpath(n.path),e.container="string"==typeof n.container?Nui.$(n.container):$(n.container);var r=e._getpath();if(r.params.length){for(var i,o=[];i=r.params.shift();)o.push(i),subs=o.join("/:"),t._params[r.path+"/:"+subs]=$.extend({},r,{params:subs.split("/:")});!0===n.split&&(t._paths[r.path]=r)}else t._paths[e.path]=r;return e._event()}},_setpath:function(e){var n=this.constructor;return(e=Nui.trim(e))&&Nui.each(n._alias,function(n,t){e=e.replace(new RegExp("{"+t+"}","g"),n)}),n._replace(e)},_getpath:function(){var e=this,n=e.path,t=e.options,a=n.indexOf("/:"),r={target:e.target,container:e.container,params:[]};return-1!==a?(r.params=n.substr(a+2).split("/:"),r.path=n.substr(0,a)):r.path=n,r.render="function"==typeof t.onRender?t.onRender:$.noop,r},_sethash:function(e){location.hash="#!"+this.constructor._replace(e)},_event:function(){var e=this,n=e.options;return e._on("click",Nui.doc,e.target,function(t,a){var r=function(){e._sethash(a.attr("href"))};return("function"!=typeof n.onBefore||!1!==n.onBefore(a,r))&&(r(),!1)}),e},_reset:function(){var e=this,n=e.constructor;return e._off(),delete n._paths[e.path],delete n._params[e.path],e}})}),Nui.define("./router",["{cpns}/router"],function(e){var n=this;return e({target:"#index",enter:!0,path:"/index",container:".g-main",onRender:n.require("./modules/index")}),e({target:"#recordVoucher",path:"/voucher/record",container:".g-main",onRender:n.require("./modules/recordVoucher")}),e({target:"#seeVoucher",path:"/voucher/list/:nickname/:career",container:".g-main",split:!0,onRender:n.require("./modules/seeVoucher")}),e}),Nui.define("./tpls/layout",function(){var e=this;return{head:e.renders('<div class="f-fl m-head-main"><% var data = list[0] %><p class="f-fl name"><% data.buname %></p><p class="f-fl month"><% data.buaddress %></p></div>'),menu:e.renders('<% each menu %><dl class="m-menu-item"><dt><a href="<% $value.path || \'javascript:void(0)\' %>"<% if $value.id %> id="<% $value.id %>"<% /if %>><em><i class="iconfont"></i></em><span><% $value.name %></span>   </a></dt><% if $value.subs && $value.subs.length %><dd><% each $value.subs %><a href="<% $value.path %>"<% if $value.id %> id="<% $value.id %>"<% /if %>><span><% $value.name %></span></a><% /each %></dd><% /if %></dl><% /each %>')}}),Nui.define("./menu",[{id:"recordVoucher",name:"录凭证",icon:"",path:"/voucher/record"},{id:"seeVoucher",name:"查凭证",icon:"",path:"/voucher/list/aniu/jser"},{name:"账簿",icon:"",subs:[{id:"summary",name:"总账",icon:"",path:"/books/summary"},{id:"detailed",name:"明细账",icon:"",path:"/books/detailed"},{id:"accountbalance",name:"科目余额表",icon:"",path:"/books/accountbalance"}]}]),Nui.define("./render",["./menu","./tpls/layout","template"],function(e,n,t){return function(a){$(".m-headbox").html(t.render(n.head,a)),a.menu=e,$(".m-menu").html(t.render(n.menu,a))}}),Nui.define("./script/page",["./render","./router","./ajax"],function(e,n,t){var a=this;a.imports("../style/base"),a.imports("../style/index"),t({url:"http://127.0.0.1/data/",success:function(t){e(t),n("trigger")}})});