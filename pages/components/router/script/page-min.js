Nui.define("./ajax",function(){var e=$.ajax;return function(t){"string"==typeof t&&(t={url:t,dataType:"json"});var n=t.success||$.noop,r=t.error||$.noop;return t.success=function(){n.apply(this,arguments)},t.error=function(){r.apply(this,arguments)},e($.extend(!0,{cache:!1,dataType:"json",statusCode:{404:function(){},502:function(){}}},t))}}),Nui.define("../tpls/seeVoucher",function(){return this.renders("这是查凭证页面，页面完整url是：<% url %>，路径是：<% path %><% if param %><br>参数分别是：<% each param %><% $index %>=<% $value %>，<% /each %><% /if %>")}),Nui.define("./modules/seeVoucher",["../tpls/seeVoucher","template"],function(e,t){return function(n,r,a){$(".m-menu-item a.s-crt").removeClass("s-crt"),n.addClass("s-crt"),r.html(t.render(e,a))}}),Nui.define("../tpls/recordVoucher",function(){return this.renders("这是录凭证页面，页面完整url是：<% url %>，路径是：<% path %>")}),Nui.define("./modules/recordVoucher",["../tpls/recordVoucher","template"],function(e,t){return function(n,r,a){$(".m-menu-item a.s-crt").removeClass("s-crt"),n.addClass("s-crt"),r.html(t.render(e,a))}}),Nui.define("../tpls/index",function(){return this.renders("<% if !cache %>这是首页，页面完整url是：<% url %>，路径是：<% path %><% else %>这是页面缓存<br><% cache %><% /if %>")}),Nui.define("./modules/index",["../tpls/index","template"],function(e,t){return function(n,r,a){$(".m-menu-item a.s-crt").removeClass("s-crt"),r.html(t.render(e,a))}}),Nui.define("{cpns}/router",function(){return this.extend("component",{static:{_trigger:!1,_domain:location.protocol+"//"+location.host,_paths:{},_params:{},_alias:{},_cache:{},_cacheContainer:{},_replace:function(e){return e.replace(this._domain,"").replace(/^\#\!?/,"").replace(/^([^\/])/,"/$1").replace(/\/$/g,"")},alias:function(e){return $.extend(this._alias,e||{})},_setCache:function(e){var t=this,e=t._oldhash;e&&Nui.each(t._cacheContainer,function(n,r){if(r===e)return t._cache[e]=n.html(),!1})},_change:function(){var e=this,t=location.hash,n=e._replace(t);$.isEmptyObject(e._paths)&&$.isEmptyObject(e._params)||(e._setCache(),Nui.each([e._paths,e._params],function(r,a){var i=!1;if(Nui.each(r,function(r){if(0===a&&n===r.path||1===a&&0===n.indexOf(r.path)){var s=n.replace(r.path,"").replace(/^\//,"");if(s=s?s.split("/"):[],s.length===r.params.length){var c;Nui.each(r.params,function(e,t){c||(c={}),c[e]=s[t]}),e._cacheContainer[t]=r.container;var o=e._cache[t];return r.render(r.target.length?r.target:$(r.target.selector),r.container,{path:r.path,url:n,param:c,cache:o}),e._trigger=i=!0,!1}}}),i)return!1}),e._trigger||Nui.each(e._instances,function(t){if(!e._hasEnter&&!0===t.options.enter)return e._hasEnter=!0,t.target.eq(0).trigger("click"),e._trigger=!0,!1})),e._oldhash=t},_bindHashchange:function(){var e=this;if(Nui.bsie7){var t=function(t){var n=location.hash;return e._oldhash!==n&&!t};setInterval(function(){t()&&e._change()},100),t(!0)}else Nui.win.on("hashchange",function(){e._change()})},trigger:function(){this._trigger||this._change()},$ready:null},options:{path:"",container:null,enter:!1,split:!1,onBefore:null,onRender:null},_init:function(){var e=this,t=e.constructor;e._exec()&&!t._bind&&(t._bind=!0,t._bindHashchange())},_exec:function(){var e=this,t=e.options,n=e.constructor,r=e._getTarget();if(t.path&&r){e.path=e._setpath(t.path),e.container="string"==typeof t.container?Nui.$(t.container):$(t.container);var a=e._getpath();if(a.params.length){for(var i,s=[];i=a.params.shift();)s.push(i),subs=s.join("/:"),n._params[a.path+"/:"+subs]=$.extend({},a,{params:subs.split("/:")});!0===t.split&&(n._paths[a.path]=a)}else n._paths[e.path]=a;return e._event()}},_setpath:function(e){var t=this.constructor;return(e=Nui.trim(e))&&Nui.each(t._alias,function(t,n){e=e.replace(new RegExp("{"+n+"}","g"),t)}),t._replace(e)},_getpath:function(){var e=this,t=e.path,n=e.options,r=t.indexOf("/:"),a={target:e.target,container:e.container,params:[]};return-1!==r?(a.params=t.substr(r+2).split("/:"),a.path=t.substr(0,r)):a.path=t,a.render="function"==typeof n.onRender?n.onRender:$.noop,a},_sethash:function(e){location.hash="#!"+this.constructor._replace(e)},_event:function(){var e=this,t=e.options;return e._on("click",Nui.doc,e.target,function(n,r){var a=function(){e._sethash(r.attr("href"))};return("function"!=typeof t.onBefore||!1!==t.onBefore(r,a))&&(a(),!1)}),e},_reset:function(){var e=this,t=e.constructor;return e._off(),delete t._paths[e.path],delete t._params[e.path],e}})}),Nui.define("./router",["{cpns}/router"],function(e){var t=this;return e({target:"#index",enter:!0,path:"/index",container:".g-main",onRender:t.require("./modules/index")}),e({target:"#recordVoucher",path:"/voucher/record",container:".g-main",onRender:t.require("./modules/recordVoucher")}),e({target:"#seeVoucher",path:"/voucher/list/:nickname/:career",container:".g-main",split:!0,onRender:t.require("./modules/seeVoucher")}),e}),Nui.define("./tpls/layout",function(){var e=this;return{head:e.renders('<div class="f-fl m-head-main"><% var data = list[0] %><p class="f-fl name"><% data.buname %></p><p class="f-fl month"><% data.buaddress %></p></div>'),menu:e.renders('<% each menu %><dl class="m-menu-item"><dt><a href="<% $value.path || \'javascript:void(0)\' %>"<% if $value.id %> id="<% $value.id %>"<% /if %>><em><i class="iconfont"></i></em><span><% $value.name %></span>   </a></dt><% if $value.subs && $value.subs.length %><dd><% each $value.subs %><a href="<% $value.path %>"<% if $value.id %> id="<% $value.id %>"<% /if %>><span><% $value.name %></span></a><% /each %></dd><% /if %></dl><% /each %>')}}),Nui.define("./menu",[{id:"recordVoucher",name:"录凭证",icon:"",path:"/voucher/record"},{id:"seeVoucher",name:"查凭证",icon:"",path:"/voucher/list/aniu/jser"},{name:"账簿",icon:"",subs:[{id:"summary",name:"总账",icon:"",path:"/books/summary"},{id:"detailed",name:"明细账",icon:"",path:"/books/detailed"},{id:"accountbalance",name:"科目余额表",icon:"",path:"/books/accountbalance"}]}]),Nui.define("./render",["./menu","./tpls/layout","template"],function(e,t,n){return function(r){$(".m-headbox").html(n.render(t.head,r)),r.menu=e,$(".m-menu").html(n.render(t.menu,r))}}),Nui.define("./script/page",["./render","./router","./ajax"],function(e,t,n){var r=this;r.imports("../style/base"),r.imports("../style/index"),n({url:"./script/data.json",success:function(n){e(n),t("trigger")}})});