Nui.define("{cpns}/placeholder",["util"],function(t){var e=this,a=t.supportHtml5("placeholder","input");return e.extend("component",{options:{text:"",animate:!1,equal:!1,color:"#ccc"},_tpllist:e.renders("<%each style%><%$index%>:<%$value%>;<%/each%>"),_tplwrap:e.renders('<strong class="ui-placeholder<%if theme%> t-placeholder-<%theme%><%/if%>" style="<%include \'_tpllist\'%>" />'),_tplelem:e.renders("<b style=\"<%include '_tpllist'%>\"><%text%></b>"),_init:function(){this._exec()},_exec:function(){var t=this;if(t.target=t._getTarget(),t.target){var e=t.deftext=t.target.attr("placeholder");!t.deftext&&t.options.text&&t.target.attr("placeholder",e=t.options.text),t.text=Nui.trim(e),t.text&&t._create()}},_create:function(){var t=this,e=t.options,n=t.constructor;e.animate||!e.animate&&!a?(e.animate&&t.target.removeAttr("placeholder"),t.target.wrap(t._tpl2html(t._tplwrap,{theme:e.theme,style:{position:"relative",display:"inline-block",width:t.target.outerWidth()+"px",overflow:"hidden",cursor:"text"}})),t.elem=$(t._tpl2html(t._tplelem,{text:t.text,style:function(){var a=t.target.outerHeight(),r=t.target.is("textarea");return{display:Nui.trim(t.target.val())?"none":"inline",position:"absolute",left:n._getSize(t.target,"l","padding")+n._getSize(t.target,"l")+"px",top:n._getSize(t.target,"t","padding")+n._getSize(t.target,"t")+"px",height:r?"auto":a+"px","line-height":r?"normal":a+"px",color:e.color}}()})).insertAfter(t.target),t._event()):t._setStyle()},_setStyle:function(){var t=this;t.options;t.className="nui-placeholder-"+t.index,t.target.addClass(t.className),t.constructor.style||t._createStyle(),t._createRules()},_createStyle:function(){var t=this,e=document.createElement("style");document.head.appendChild(e),t.constructor.style=e.sheet},_createRules:function(){var t=this,e=t.constructor.style,a=t.index;try{e.deleteRule(a)}catch(t){}Nui.each(["::-webkit-input-placeholder",":-ms-input-placeholder","::-moz-placeholder"],function(n){var r="."+t.className+n,i="opacity:1; color:"+(t.options.color||"");try{"addRule"in e?e.addRule(r,i,a):"insertRule"in e&&e.insertRule(r+"{"+i+"}",a)}catch(t){}})},_event:function(){var t=this,e=t.options,a=t.constructor,n=a._getSize(t.target,"l","padding")+a._getSize(t.target,"l");t._on("click",t.elem,function(){t.target.focus()}),t._on("focus",t.target,function(){e.animate&&t.elem.stop(!0,!1).animate({left:n+10,opacity:"0.5"})}),t._on("blur change",t.target,function(a,r){var i=Nui.trim(r.val());!e.equal&&i===t.text||!i?(r.val(""),t.elem.show(),e.animate&&t.elem.stop(!0,!1).animate({left:n,opacity:"1"})):t.elem.hide()}),t._on("keyup keydown",t.target,function(e,a){Nui.trim(a.val())?t.elem.hide():t.elem.show()})},_reset:function(){var t=this;t._off(),t.elem&&(t.elem.remove(),t.target.unwrap()),t.target.removeClass(t.className),t.deftext?t.target.attr("placeholder",t.deftext):t.target.removeAttr("placeholder")}})}),Nui.define("{cpns}/router",function(){return this.extend("component",{static:{_trigger:!1,_domain:location.protocol+"//"+location.host,_paths:{},_params:{},_alias:{},_cache:{},_cacheContainer:{},_replace:function(t){return t.replace(this._domain,"").replace(/^\#\!?/,"").replace(/^([^\/])/,"/$1").replace(/\/$/g,"")},alias:function(t){return $.extend(this._alias,t||{})},_setCache:function(t){var e=this,t=e._oldhash;t&&Nui.each(e._cacheContainer,function(a,n){if(n===t)return e._cache[t]=a.html(),!1})},_change:function(){var t=this,e=location.hash,a=t._replace(e);$.isEmptyObject(t._paths)&&$.isEmptyObject(t._params)||(t._setCache(),Nui.each([t._paths,t._params],function(n,r){var i=!1;if(Nui.each(n,function(n){if(0===r&&a===n.path||1===r&&0===a.indexOf(n.path)){var o=a.replace(n.path,"").replace(/^\//,"");if(o=o?o.split("/"):[],o.length===n.params.length){var c={};Nui.each(n.params,function(t,e){c[t]=o[e]}),t._cacheContainer[e]=n.container;var l=t._cache[e];return n.render(n.target,n.container,{path:n.path,url:a,param:c,cache:l}),t._trigger=i=!0,!1}}}),i)return!1}),t._trigger||Nui.each(t._instances,function(e){if(!0===e.options.enter)return e.target.eq(0).trigger("click"),t._trigger=!0,!1})),t._oldhash=e},_bindHashchange:function(){var t=this;if(Nui.bsie7){var e=function(e){var a=location.hash;return t._oldhash!==a&&!e};setInterval(function(){e()&&t._change()},100),e(!0)}else Nui.win.on("hashchange",function(){t._change()})},trigger:function(){this._trigger||this._change()},$ready:null},options:{path:"",container:null,enter:!1,onBefore:null,onRender:null},_init:function(){var t=this,e=t.constructor;t._exec()&&!e._bind&&(e._bind=!0,e._bindHashchange())},_exec:function(){var t=this,e=t.options,a=t.constructor;if(t.path=t._setpath(e.path),t.target=t._getTarget(),t.container=$(e.container),e.path&&t.target){var n=t._getpath();if(n.params.length){var r=[];Nui.each(n.params,function(t){r.push(t);var e=r.join("/:");a._params[n.path+"/:"+e]=$.extend({},n,{params:e.split("/:")})}),a._params[t.path]=n}else a._paths[t.path]=n;return t._event()}},_setpath:function(t){var e=this.constructor;return(t=Nui.trim(t))&&Nui.each(e._alias,function(e,a){t=t.replace(new RegExp("{"+a+"}","g"),e)}),e._replace(t)},_getpath:function(){var t=this,e=t.path,a=t.options,n=e.indexOf("/:"),r={target:t.target,container:t.container,params:[]};return-1!==n?(r.params=e.substr(n+2).split("/:"),r.path=e.substr(0,n)):r.path=e,r.render="function"==typeof a.onRender?a.onRender:$.noop,r},_sethash:function(t){location.hash="#!"+this.constructor._replace(t)},_event:function(){var t=this,e=t.options;return t._on("click",Nui.doc,t.target,function(a,n){var r=function(){t._sethash(n.attr("href"))};return("function"!=typeof e.onBefore||!1!==e.onBefore(n,r))&&(r(),!1)}),t},_reset:function(){var t=this,e=t.constructor;return t._off(),delete e._paths[t.path],delete e._params[t.path],t}})}),Nui.define("./script/page",["{cpns}/router","{cpns}/placeholder"],function(t,e){});