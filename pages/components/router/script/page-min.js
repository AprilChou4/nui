Nui.define("./ajax",function(){var e=$.ajax;return function(t){"string"==typeof t&&(t={url:t,dataType:"json"});var n=t.success||$.noop,a=t.error||$.noop;return t.success=function(){n.apply(this,arguments)},t.error=function(){a.apply(this,arguments)},e($.extend(!0,{cache:!1,dataType:"json",statusCode:{404:function(){},502:function(){}}},t))}}),Nui.define("../tpls/seeVoucher",function(){return this.renders("这是查凭证页面，页面完整url是：<% url %>，路径是：<% path %><% if param %><br>参数分别是：<% each param %><% $index %>=<% $value %>，<% /each %><% /if %>")}),Nui.define("./modules/seeVoucher",["../tpls/seeVoucher","template"],function(e,t){return function(n,a,i){$(".m-menu-item a.s-crt").removeClass("s-crt"),n.addClass("s-crt"),a.html(t.render(e,i))}}),Nui.define("highlight",function(){var e=this.renders;return this.extend("component",{static:{_getcode:function(e,t){return'<code class="'+e+'">'+t+"</code>"},_getarr:function(e,t){var n=[];return e?(Nui.each(e,function(e){var a=t.indexOf(e),i=t.substr(0,a);t=t.substr(a+e.length),n.push(i),n.push(e)}),n.push(t)):n.push(t),n},_comment:function(e){return/\/\*/.test(e)?e=e.replace(/(\/\*(.|\s)*?\*\/)/g,this._getcode("comment","$1")):/\/\//.test(e)&&(e=e.replace(/(\/\/.*)$/g,this._getcode("comment","$1"))),e}},options:{isTitle:!1,isLight:!0,isLine:!1},_type:"",_init:function(){this._exec()},_exec:function(){var e=this,t=e._getTarget();if(t){var n=t.get(0);"SCRIPT"===n.tagName&&"text/highlight"==n.type&&(e.code=t.html().replace(/^[\r\n]+|[\r\n]+$/g,"").replace(/</g,"&lt;").replace(/>/g,"&gt;"),e.element&&e.element.remove(),e._create(),e.options.isLight&&e._event())}},_tpl:e('<div class="ui-highlight<%if type%> ui-highlight-<%type%><%/if%><%if theme%> t-highlight-<%theme%><%/if%>"><%if isTitle%><div class="title"><em class="type"><%type%></em></div><%/if%><div class="inner"><table><%each list val key%><tr><%if isLine === true%><td class="line" number="<%key+1%>"><%if bsie7%><%key+1%><%/if%></td><%/if%><td class="code"><%val%></td></tr><%/each%></table><div></div>'),_create:function(){var e=this,t=(e.options,$.extend({bsie7:Nui.bsie7,list:e._list(),type:e._type},e.options||{})),n=e._tpl2html.call(e,e._tpl,t);e.element=$(n).insertAfter(e.target)},_list:function(){var e=this;return e._type?e["_"+e._type](e.code).split("\n"):e.code.split("\n")},_event:function(){var e=this;e.evt=!1,e._on("click",e.element,"tr",function(t,n){e.evt=!0,n.addClass("s-crt").siblings().removeClass("s-crt")}),e._on("click",e.element,function(e){e.stopPropagation()}),e._on("click",Nui.doc,function(t){e.evt&&(e.element.find("tr.s-crt").removeClass("s-crt"),e.evt=!1)})}})}),Nui.define("{light}/javascript",function(){return this.extend("highlight",{_type:"js",_js:function(e){var t=this,n=t.constructor,a="",i=e.match(/(\/\/.*)|(\/\*(.|\s)*?\*\/)|('[^']*')|("[^"]*")/g),r=n._getarr(i,e);return Nui.each(r,function(e){$.trim(e)&&(/^\s*\/\//.test(e)?e=n._getcode("comment",e):/^\s*\/\*/.test(e)?e=e.replace(/(.+)/g,n._getcode("comment","$1")):(e=/'|"/.test(e)?e.replace(/(.+)/g,n._getcode("string","$1")):e.replace(new RegExp("(&lt;|&gt;|;|!|%|\\|\\[|\\]|\\(|\\)|\\{|\\}|\\=|\\/|-|\\+|,|\\.|\\:|\\?|~|\\*|&)","g"),n._getcode("symbol","$1")).replace(new RegExp("(abstract|arguments|boolean|break|byte|case|catch|char|class|const|continue|debugger|default|delete|do|double|else|elseif|each|enum|eval|export|extends|false|final|finally|float|for|function|goto|if|implements|import|in|instanceof|int|include|interface|let|long|native|new|null|package|private|protected|public|return|short|static|super|switch|synchronized|this|throw|throws|transient|true|try|typeof|var)(\\s+|\\<code)","g"),n._getcode("keyword","$1")+"$2").replace(/(\/code>\s*)(\d+)/g,"$1"+n._getcode("number","$2")).replace(/(\/code>\s*)?([^<>\s]+)(\s*<code)/g,"$1"+n._getcode("word","$2")+"$3"),e=n._comment(e))),a+=e}),a}})}),Nui.define("../tpls/recordVoucher",function(){return this.renders('<input type="text" placeholder="aaaaaaaaaaa" data-placeholder-options=\'{"color":"#f60", "animate":true}\' /><script type="text/highlight" data-javascript-options>var a = 1;var b = 2;</script> <a id="aaa">aaaaaaaaaaa</a>')}),Nui.define("./modules/recordVoucher",["component","../tpls/recordVoucher","template","{light}/javascript"],function(e,t,n,a){return function(i,r,s){$(".m-menu-item a.s-crt").removeClass("s-crt"),i.addClass("s-crt"),r.html(n.render(t,s)).find("#aaa").click(function(){a("destroy",r),setTimeout(function(){a("init",r),a("set",r,{isLine:!0})},2e3)}),e.static.init(r)}}),Nui.define("./menu",[{id:"recordVoucher",name:"录凭证",index:!0,icon:"",path:"/voucher/record"},{id:"seeVoucher",name:"查凭证",icon:"",index:!0,path:"/voucher/list/aniu/jser"},{name:"账簿",icon:"",subs:[{id:"summary",name:"总账",icon:"",path:"/books/summary"},{id:"detailed",name:"明细账",icon:"",path:"/books/detailed"},{id:"accountbalance",name:"科目余额表",icon:"",path:"/books/accountbalance"}]}]),Nui.define("../tpls/index",function(){return this.renders('<div class="m-main ui-bgw"><h3 class="ui-bdb ui-fcb"><em class="ui-animate ui-animate-fadeInDown ui-animate-fadeInDown-run1">欢</em><em class="ui-animate ui-animate-fadeInDown ui-animate-fadeInDown-run2">迎</em><em class="ui-animate ui-animate-fadeInDown ui-animate-fadeInDown-run3">使</em><em class="ui-animate ui-animate-fadeInDown ui-animate-fadeInDown-run4">用</em><em class="ui-animate ui-animate-fadeInDown ui-animate-fadeInDown-run5">云</em><em class="ui-animate ui-animate-fadeInDown ui-animate-fadeInDown-run6">记</em><em class="ui-animate ui-animate-fadeInDown ui-animate-fadeInDown-run7">账</em><em class="ui-animate ui-animate-fadeInDown ui-animate-fadeInDown-run8">！</em></h3><ul><% each $list %><% if $value.index %><li><a href="<% $value.path %>" id="<% $value.id %>Index"><em><i class="iconfont ui-animate">&#xe62a;</i></em><span class="ui-animate"><% $value.name %></span></a></li><% /if %><% /each %></ul></div>')}),Nui.define("./modules/index",["../tpls/index","template","../menu"],function(e,t,n){return this.imports("../../style/index"),function(a,i,r){$(".m-menu-item a.s-crt").removeClass("s-crt"),i.html(t.render(e,n))}}),Nui.define("{cpns}/router",function(){return this.extend("component",{static:{_running:!1,_domain:location.protocol+"//"+location.host,_paths:{},_params:{},_alias:{},_cache:{},_cacheContainer:{},_replace:function(e){return e.replace(this._domain,"").replace(/^\#\!?/,"").replace(/^([^\/])/,"/$1").replace(/\/$/g,"")},alias:function(e){return $.extend(this._alias,e||{})},_setCache:function(e){var t=this,e=t._oldhash;e&&Nui.each(t._cacheContainer,function(n,a){if(n&&a===e)return t._cache[e]=n.html(),!1})},_change:function(){var e=this,t=location.hash,n=e._replace(t);$.isEmptyObject(e._paths)&&$.isEmptyObject(e._params)||(e._setCache(),Nui.each([e._paths,e._params],function(a,i){var r=!1;if(Nui.each(a,function(a){if(0===i&&n===a.path||1===i&&0===n.indexOf(a.path)){var s=n.replace(a.path,"").replace(/^\//,"");if(s=s?s.split("/"):[],s.length===a.params.length){var c;Nui.each(a.params,function(e,t){c||(c={}),c[e]=s[t]}),e._cacheContainer[t]=a.container;var o=e._cache[t];return a.render(a.target.length?a.target:$(a.target.selector),a.container,{path:a.path,url:n,param:c,cache:o}),e._running=r=!0,!1}}}),r)return!1}),e._running||Nui.each(e._instances,function(t){if(!e._hasEnter&&!0===t.options.enter)return e._hasEnter=!0,t.target.eq(0).trigger("click"),e._running=!0,!1})),e._oldhash=t},_bindHashchange:function(){var e=this;if(Nui.bsie7){var t=function(t){var n=location.hash;return e._oldhash!==n&&!t};setInterval(function(){t()&&e._change()},100),t(!0)}else Nui.win.on("hashchange",function(){e._change()})},run:function(){this._running||this._change()},$ready:null},options:{path:"",container:null,enter:!1,splitLevel:1,onBefore:null,onRender:null},_init:function(){var e=this,t=e.constructor;e._exec()&&!t._bind&&(t._bind=!0,t._bindHashchange())},_exec:function(){var e=this,t=e.options,n=e.constructor,a=e._getTarget();if(t.path&&a){e.path=e._setpath(t.path),e.container=e._jquery(t.container);var i=e._getpath();if(i.params.length)if(t.splitLevel){if(t.splitLevel<=2)for(var r,s=[];r=i.params.shift();)s.push(r),subs=s.join("/:"),n._params[i.path+"/:"+subs]=$.extend({},i,{params:subs.split("/:")});2===t.splitLevel&&(n._paths[i.path]=i)}else n._params[e.path]=i;else n._paths[e.path]=i;return e._event()}},_setpath:function(e){var t=this.constructor;return(e=Nui.trim(e))&&Nui.each(t._alias,function(t,n){e=e.replace(new RegExp("{"+n+"}","g"),t)}),t._replace(e)},_getpath:function(){var e=this,t=e.path,n=e.options,a=t.indexOf("/:"),i={target:e.target,container:e.container,params:[]};return-1!==a?(i.params=t.substr(a+2).split("/:"),i.path=t.substr(0,a)):i.path=t,i.render="function"==typeof n.onRender?n.onRender:$.noop,i},_sethash:function(e){location.hash="#!"+this.constructor._replace(e)},_event:function(){var e=this,t=e.options;return e._on("click",Nui.doc,e.target,function(n,a){var i=function(){e._sethash(a.attr("href"))};return("function"!=typeof t.onBefore||!1!==t.onBefore(a,i))&&(i(),!1)}),e},_reset:function(){var e=this,t=e.constructor;return e._off(),delete t._paths[e.path],delete t._params[e.path],e}})}),Nui.define("./router",["{cpns}/router"],function(e){var t=this;return e({target:"#index",enter:!0,path:"/index",container:".g-main",onRender:t.require("./modules/index")}),e({target:"#recordVoucher, #recordVoucherIndex",path:"/voucher/record",container:".g-main",onRender:t.require("./modules/recordVoucher")}),e({target:"#seeVoucher, #seeVoucherIndex",path:"/voucher/list/:nickname/:career",container:".g-main",splitLevel:2,onRender:t.require("./modules/seeVoucher")}),e}),Nui.define("./tpls/layout",function(){var e=this;return{head:e.renders('<div class="f-fl m-head-main"><% var data = list[0] %><p class="f-fl name"><% data.buname %></p><p class="f-fl month"><% data.buaddress %></p></div>'),menu:e.renders('<% each menu %><dl class="m-menu-item"><dt><a href="<% $value.path || \'javascript:void(0)\' %>"<% if $value.id %> id="<% $value.id %>"<% /if %>><em><i class="iconfont"></i></em><span><% $value.name %></span>   </a></dt><% if $value.subs && $value.subs.length %><dd><% each $value.subs %><a href="<% $value.path %>"<% if $value.id %> id="<% $value.id %>"<% /if %>><span><% $value.name %></span></a><% /each %></dd><% /if %></dl><% /each %>')}}),Nui.define("./render",["./menu","./tpls/layout","template"],function(e,t,n){return function(a){$(".m-headbox").html(n.render(t.head,a)),a.menu=e,$(".m-menu").html(n.render(t.menu,a))}}),Nui.define("./script/page",["./render","./router","./ajax"],function(e,t,n){var a=this;a.imports("../style/base"),a.imports("../style/page"),n({url:"./script/data.json",success:function(n){e(n),t("run")}})});