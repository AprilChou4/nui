Nui.define("./data",["国内","国际","娱乐","体育"]),Nui.define("./detail",["template","./data"],function(e,t){var n=this;return e.method("filter",function(e){return t[e]}),{render:function(t,a,r){a.html(e.render(n.renders('<% if param.id === undefined %><p>下面是<% filter | param.type %>新闻列表：</p><ul><li class="e-mt10"><a class="detail" href="/news/<% param.type %>/1111">1111111111111111111</a></li><li class="e-mt10"><a class="detail" href="/news/<% param.type %>/2222">222222222222222222</a></li><li class="e-mt10"><a class="detail" href="/news/<% param.type %>/3333">3333333333333333</a></li><li class="e-mt10"><a class="detail" href="/news/<% param.type %>/4444">4444444444444444444</a></li></ul><% else %><% var cols = new Array(8), lines = new Array(20) %><% each lines %><p><% each cols %><% param.id %><% /each %></p><% /each %><% /if %>'),r))}}}),Nui.define("./news",["template","./data"],function(e,t){var n=this;return{render:function(a,r,i){i.data=t,r.html(e.render(n.renders('<p>下面是新闻分类：</p><% each data %><a href="/news/<% $index %>" class="detail e-ml10"><% $value %></a><% /each %>'),i))}}}),Nui.define("./home",["template"],function(e){var t=this;return{render:function(n,a,r){a.html(e.render(t.renders("Hi！欢迎来到首页。"),r))}}}),Nui.define("{cpns}/router",function(){return this.extend("component",{static:{_trigger:!1,_domain:location.protocol+"//"+location.host,_paths:{},_params:{},_alias:{},_cache:{},_replace:function(e){return e.replace(this._domain,"").replace(/^\#\!?/,"").replace(/^([^\/])/,"/$1").replace(/\/$/g,"")},alias:function(e){return $.extend(this._alias,e||{})},_change:function(){var e=this,t=e._replace(location.hash);$.isEmptyObject(e._paths)&&$.isEmptyObject(e._params)||(Nui.each([e._paths,e._params],function(n,a){var r=!1;if(Nui.each(n,function(n){if(0===a&&t===n.path||1===a&&0===t.indexOf(n.path)){var i=t.replace(n.path,"").replace(/^\//,"");if(i=i?i.split("/"):[],i.length===n.params.length){var s={};return Nui.each(n.params,function(e,t){s[e]=i[t]}),n.render(n.target,n.container,{path:n.path,param:s}),e._trigger=r=!0,!1}}}),r)return!1}),e._trigger||Nui.each(e._instances,function(t){if(!0===t.options.enter)return t.target.eq(0).trigger("click"),e._trigger=!0,!1}))},_bindHashchange:function(){var e=this;if(Nui.bsie7){var t=function(t){var n=location.hash;return e._oldhash!==n&&(e._oldhash=n,!t)};setInterval(function(){t()&&e._change()},100),t(!0)}else Nui.win.on("hashchange",function(){e._change()})},trigger:function(){this._trigger||this._change()},$ready:null},options:{path:"",container:null,enter:!1,onBefore:null,onRender:null},_init:function(){var e=this,t=e.constructor;e._exec()&&!t._bind&&(t._bind=!0,t._bindHashchange())},_exec:function(){var e=this,t=e.options,n=e.constructor;if(e.path=e._setpath(t.path),e.target=e._getTarget(),e.container=$(t.container),t.path&&e.target){var a=e._getpath();if(a.params.length){var r=[];Nui.each(a.params,function(e){r.push(e);var t=r.join("/:");n._params[a.path+"/:"+t]=$.extend({},a,{params:t.split("/:")})}),n._params[e.path]=a}else n._paths[e.path]=a;return e._event()}},_setpath:function(e){var t=this.constructor;return(e=Nui.trim(e))&&Nui.each(t._alias,function(t,n){e=e.replace(new RegExp("{"+n+"}","g"),t)}),t._replace(e)},_getpath:function(){var e=this,t=e.path,n=e.options,a=t.indexOf("/:"),r={target:e.target,container:e.container,params:[]};return-1!==a?(r.params=t.substr(a+2).split("/:"),r.path=t.substr(0,a)):r.path=t,r.render="function"==typeof n.onRender?n.onRender:$.noop,r},_sethash:function(e){location.hash="#!"+this.constructor._replace(e)},_event:function(){var e=this,t=e.options;return e._on("click",e.target,function(n,a){var r=function(){e._sethash(a.attr("href"))};return("function"!=typeof t.onBefore||!1!==t.onBefore(a,r))&&(r(),!1)}),e},_reset:function(){var e=this,t=e.constructor;return e._off(),delete t._paths[e.path],delete t._params[e.path],e}})}),Nui.define("./script/page",["{cpns}/router"],function(e){var t=this,n=$(".content");e({target:"#home",path:"/home/",enter:!0,container:n,onRender:t.require("./home").render}),e({target:"#news",path:"/news/",container:n,onRender:t.require("./news").render}),e({target:".detail",path:"/news/:type/:id/",container:n,onBefore:function(e){if("娱乐"===e.text())return alert("该板块尚未开通"),!1},onRender:t.require("./detail").render}),e("trigger")});