Nui.define("highlight",function(){var e=this.renders;return this.extend("component",{static:{_getcode:function(e,t){return'<code class="'+e+'">'+t+"</code>"},_getarr:function(e,t){var s=[];return e?($.each(e,function(e,i){var c=t.indexOf(i),r=t.substr(0,c);t=t.substr(c+i.length),s.push(r),s.push(i)}),s.push(t)):s.push(t),s},_comment:function(e){return/\/\*/.test(e)?e=e.replace(/(\/\*(.|\s)*?\*\/)/g,this._getcode("comment","$1")):/\/\//.test(e)&&(e=e.replace(/(\/\/.*)$/g,this._getcode("comment","$1"))),e}},options:{isTitle:!1,isLight:!0,isLine:!0},_type:"",_init:function(){this._exec()},_exec:function(){var e=this;if(e.target=e._getTarget(),e.target){var t=e.target.get(0);"SCRIPT"===t.tagName&&"text/highlight"==t.type&&(e.code=e.target.html().replace(/^[\r\n]+|[\r\n]+$/g,"").replace(/</g,"&lt;").replace(/>/g,"&gt;"),e.elem&&e.elem.remove(),e._create(),e.options.isLight&&e._event())}},_tpl:e('<div class="ui-highlight{{if type}} ui-highlight-{{type}}{{/if}}{{if theme}} t-highlight-{{theme}}{{/if}}">{{if isTitle}}<div class="title"><em class="type">{{type}}</em></div>{{/if}}<div class="inner"><table>{{each list val key}}<tr>{{if isLine === true}}<td class="line" number="{{key+1}}">{{if bsie7}}{{key+1}}{{/if}}</td>{{/if}}<td class="code">{{val}}</td></tr>{{/each}}</table><div></div>'),_create:function(){var e=this,t=(e.options,$.extend({bsie7:Nui.bsie7,list:e._list(),type:e._type},e.options||{})),s=e._tpl2html.call(e,e._tpl,t);e.elem=$(s).insertAfter(e.target)},_list:function(){var e=this;return e._type?e["_"+e._type](e.code).split("\n"):e.code.split("\n")},_event:function(){var e=this;e._on("click",e.elem.find("tr"),function(e){$(this).addClass("s-crt").siblings().removeClass("s-crt")}),e._on("click",e.elem,function(e){e.stopPropagation()}),e._on("click",Nui.doc,function(t){e.elem.find("tr.s-crt").removeClass("s-crt")})}})}),Nui.define("./style",function(){return this.extend("highlight",{_type:"css",_css:function(e){var t=this,s=t.constructor,i="",c=e.match(/(\/\*(.|\s)*?\*\/)|(\{[^\{\}\/]*\})/g),r=s._getarr(c,e);return $.each(r,function(e,t){$.trim(t)&&(t=/^\s*\/\*/.test(t)?t.replace(/(.+)/g,s._getcode("comment","$1")):/\}\s*$/.test(t)?t.replace(/(\s*)([^:;\{\}\/\*]+)(:)([^:;\{\}\/\*]+)/g,"$1"+s._getcode("attr","$2")+"$3"+s._getcode("string","$4")).replace(/([\:\;\{\}])/g,s._getcode("symbol","$1")):t.replace(/([^\:\{\}\@\#\s\.]+)/g,s._getcode("selector","$1")).replace(/([\:\{\}\@\#\.])/g,s._getcode("symbol","$1"))),i+=t}),i}})}),Nui.define("./javascript",function(){return this.extend("highlight",{_type:"js",_js:function(e){var t=this,s=t.constructor,i="",c=e.match(/(\/\/.*)|(\/\*(.|\s)*?\*\/)|('[^']*')|("[^"]*")/g),r=s._getarr(c,e);return $.each(r,function(e,t){$.trim(t)&&(/^\s*\/\//.test(t)?t=s._getcode("comment",t):/^\s*\/\*/.test(t)?t=t.replace(/(.+)/g,s._getcode("comment","$1")):(t=/'|"/.test(t)?t.replace(/(.+)/g,s._getcode("string","$1")):t.replace(new RegExp("(&lt;|&gt;|;|!|%|\\|\\[|\\]|\\(|\\)|\\{|\\}|\\=|\\/|-|\\+|,|\\.|\\:|\\?|~|\\*|&)","g"),s._getcode("symbol","$1")).replace(new RegExp("(abstract|arguments|boolean|break|byte|case|catch|char|class|const|continue|debugger|default|delete|do|double|else|enum|eval|export|extends|false|final|finally|float|for|function|goto|if|implements|import|in|instanceof|int|interface|let|long|native|new|null|package|private|protected|public|return|short|static|super|switch|synchronized|this|throw|throws|transient|true|try|typeof|var)(\\s+|\\<code)","g"),s._getcode("keyword","$1")+"$2").replace(/(\/code>\s*)(\d+)/g,"$1"+s._getcode("number","$2")).replace(/(\/code>\s*)?([^<>\s]+)(\s*<code)/g,"$1"+s._getcode("word","$2")+"$3"),t=s._comment(t))),i+=t}),i}})}),Nui.define("{light}/xml",["./javascript","./style"],function(e,t){return this.extend("highlight",{_type:"xml",_xml:function(s){var i=this,c=i.constructor,r="";return s=s.replace(/&lt;\s*![^!]+-\s*&gt;/g,function(e){return e.replace(/&lt;/g,"<<").replace(/&gt;/g,">>")}),$.each(s.split("&lt;"),function(s,n){n=n.split("&gt;");var o=n.length;$.each(n,function(s,l){if($.trim(l)){if(0==s){var a=!1;if(/^\s*\//.test(l))l=l.replace(/([^\r\n\/]+)/g,c._getcode("tag","$1")).replace(/^(\s*\/+)/,c._getcode("symbol","$1"));else{var g=l.match(/^\s+/)||"";/\=\s*['"]$/.test(l)&&(a=!0),l=l.replace(/^\s+/,"").replace(/(\s+)([^'"\/\s\=]+)((\s*=\s*)(['"]?[^'"]*['"]?))?/g,"$1"+c._getcode("attr","$2")+c._getcode("symbol","$4")+c._getcode("string","$5")).replace(/<code class="\w+">(\s*((<<\s*![-\s]+)|([-\s]+>>))?)<\/code>/g,"$1").replace(/^([^\s]+)/,c._getcode("tag","$1")).replace(/(\/+\s*)$/,c._getcode("symbol","$1")),l=g+l}l=c._getcode("symbol","&lt;")+l,a||(l+=c._getcode("symbol","&gt;"))}else if(3===o&&1===s&&/\s*['"]\s*/.test(l))l=l.replace(/(\s*['"]\s*)/,c._getcode("symbol","$1"))+c._getcode("symbol","&gt;");else{var p=$.trim(n[0]).toLowerCase();l="style"==p?t.exports._css.call(i,l):"script"==p?e.exports._js.call(i,l):l.replace(/(.+)/g,c._getcode("text","$1"))}l=l.replace(/<<\s*![^!]+-\s*>>/g,function(e){return e.replace(/([^\r\n]+)/g,c._getcode("comment","$1")).replace(/<</g,"&lt;").replace(/>>/g,"&gt;")})}r+=l})}),r}})}),Nui.define("{script}/base",["{light}/xml"],function(){this.imports("../style/base");var e=location.hash.replace("#",""),t=$(".g-main"),s=t.find("h2"),i=(s.length,$(".m-menu ul"));return{init:function(){this.setYear(),this.event(),this.position()},setYear:function(){$("#nowyear").text("-"+(new Date).getFullYear())},position:function(){e&&t.scrollTop($('[id="'+e+'"]').offset().top-$(".g-header").outerHeight())},event:function(){t.scroll(function(){var e=t.scrollTop();s.each(function(t){var c=$(this),r=this.id,n=c.position().top-20,o=0,l=s.eq(t+1);if(o=l.length?l.position().top-20:$(".mainbox").outerHeight(),i.find("a.s-crt").removeClass("s-crt"),e>=n&&e<o)return i.find('a[href="#'+r+'"]').addClass("s-crt"),c.removeAttr("id"),location.hash=r,c.attr("id",r),!1})})}}});